{% extends "base.html" %}
{% block body %}

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap');

*{
  box-sizing:border-box;
  font-family: Inter, sans-serif;
}

.product-page{
  max-width:1200px;
  margin:80px auto;
  padding:0 30px;
  display:grid;
  grid-template-columns:1.1fr 0.9fr;
  gap:80px;
}

/* ===== LEFT IMAGE ===== */
/* ===== FIXED HEIGHT SLIDER (NO JUMP) ===== */
.product-image{
  width:100%;
}

.slider{
  position: relative;
  width:100%;
  height:520px;        /* LOCK HEIGHT */
  overflow:hidden;
  background:#f5f5f5;  /* optional neutral bg */
}

.slide{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:contain;  /* PREVENT CROPPING */
  display:none;
  background:white;
}

.slide.active{
  display:block;
}

/* ARROWS */
.arrow{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  background:white;
  border:none;
  font-size:28px;
  color:#000;
  cursor:pointer;
  opacity:0.7;
}

.prev{ left:10px; }
.next{ right:10px; }

.arrow:hover{ opacity:1; }



/* ===== RIGHT INFO ===== */
.product-info h1{
  font-size:22px;
  font-weight:500;
  letter-spacing:1px;
  margin-bottom:8px;
}

.price{
  font-size:14px;
  margin-bottom:4px;
}

.tax{
  font-size:11px;
  opacity:.6;
  margin-bottom:20px;
}

/* SIZE */
.label{
  font-size:11px;
  margin-bottom:6px;
  display:block;
}

.size-options{
  display:flex;
  gap:10px;
  margin-bottom:22px;
}

.size-options button{
  padding:8px 14px;
  border:1px solid #ccc;
  background:#fff;
  font-size:11px;
  cursor:pointer;
}

.size-options button.active{
  background:#000;
  color:#fff;
  border-color:#000;
}

/* QUANTITY */
.qty-wrap{
  display:flex;
  align-items:center;
  border:1px solid #ccc;
  width:max-content;
  margin-bottom:25px;
}

.qty-wrap button{
  border:none;
  background:none;
  padding:8px 14px;
  font-size:16px;
  cursor:pointer;
}
.size{
  margin-top:0px;
  font-size:12px;
  line-height:1.6;
  opacity:.95;

}
.qty-value{
  padding:0 18px;
  font-size:13px;
}

.add-to-cart {
  width: 100%;
  padding: 14px;
  font-size: 12px;
  letter-spacing: 0.5px;
  text-transform: uppercase;

  background: #fff;
  color: #000;
  border: 1px solid #000;

  cursor: pointer;
  transition: background-color 0.25s ease,
              color 0.25s ease;
}

/* Hover effect exactly like image */
.add-to-cart:hover {
  background: #000;
  color: #fff;
}


/* DESCRIPTION */
.desc{
  margin-top:15px;
  font-size:12px;
  line-height:1.6;
  opacity:.75;
}

/* RESPONSIVE */
@media(max-width:900px){
  .product-page{
    grid-template-columns:1fr;
    gap:40px;
  }
}
</style>

<section class="product-page">

  <!-- LEFT IMAGE -->
<div class="product-image">

  <div class="slider">
    <img src="{{ product.image1.url }}" class="slide active" alt="Product image 1">
    <img src="{{ product.image2.url }}" class="slide" alt="Product image 2">

    <!-- ARROWS -->
    <button class="arrow prev" onclick="changeSlide(-1)">‹</button>
    <button class="arrow next" onclick="changeSlide(1)">›</button>
  </div>

</div>

  <!-- RIGHT DETAILS -->
  <div class="product-info">
    <h1>{{ product.name }}</h1>

    <div class="price">₹{% widthratio product.price 3 1 %} INR</div>
    <div class="tax">Taxes included</div>

    <span class="label">Size</span>
    <div class="size-options">
      <button class="active">M</button>
      <button class="active">L</button>
      <button class="active">XL</button>



    </div>
    <div class="size" >
     {{ product.descp }}
    </div>
    <br>

    <span class="label">Quantity</span>
    <div class="qty-wrap">
      <button onclick="changeQty(-1)">−</button>
      <div class="qty-value" id="qty">1</div>
      <button onclick="changeQty(1)">+</button>
    </div>

    <button 
  type="button"
  id="add-cart"
  class="add-to-cart"
  data-product-id="{{ product.id }}">
  Add to cart
</button>

    <!-- Remove this if you don't want Buy Now -->
    {% comment %} <button class="btn btn-fill">Buy it now</button> {% endcomment %}

    <div class="desc" >
      Each order contains a set of 3 pieces.<br>
      Premium Fabric – Garment Washed<br>
      Cold wash · Wash inside out · Do not bleach · Hang to dry · Low heat iron
      
    </div>
  </div>

</section>
<script>

/* SLIDER LOGIC */
let currentSlide = 0;
const slides = document.querySelectorAll(".slide");

function changeSlide(direction){
  slides[currentSlide].classList.remove("active");
  currentSlide = (currentSlide + direction + slides.length) % slides.length;
  slides[currentSlide].classList.add("active");
}
</script>

<script>
/* ===== QUANTITY ===== */
let qty = 1;

function changeQty(val){
  qty += val;
  if(qty < 1) qty = 1;
  document.getElementById("qty").innerText = qty;
}

/* ===== CSRF ===== */
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
const csrftoken = getCookie('csrftoken');

/* ===== ADD TO CART ===== */
$(document).on('click', '#add-cart', function(e){
    e.preventDefault();

    $.ajax({
        type: 'POST',
        url: "{% url 'cart_add' %}",
        data: {
            product_id: $(this).data('product-id'),
            quantity: qty,
            csrfmiddlewaretoken: csrftoken,
            action: 'post'
        },
        success: function(json){
            console.log("SUCCESS:", json);
        },
        error: function(xhr, errmsg, err){
            console.log("ERROR:", errmsg);
        }
    });
});
</script>



{% endblock body %}
